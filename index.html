
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Connect to your Tabular models in Python!">
      
      
      
        <link rel="canonical" href="https://curts0.github.io/PyTabular/">
      
      
      
        <link rel="next" href="Tabular/">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.2">
    
    
      
        <title>PyTabular</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.50c56a3b.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pytabular" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="PyTabular" class="md-header__button md-logo" aria-label="PyTabular" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PyTabular
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Home
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Curts0/PyTabular" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Curts0/PyTabular
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="PyTabular" class="md-nav__button md-logo" aria-label="PyTabular" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    PyTabular
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Curts0/PyTabular" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    Curts0/PyTabular
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Home
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-it" class="md-nav__link">
    <span class="md-ellipsis">
      What is it?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Started
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Use Cases
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Use Cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#if-a-blank-table-then-refresh-the-table" class="md-nav__link">
    <span class="md-ellipsis">
      If a blank table, then refresh the table.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sneak-in-a-refresh" class="md-nav__link">
    <span class="md-ellipsis">
      Sneak in a refresh.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show-refresh-times-in-the-model" class="md-nav__link">
    <span class="md-ellipsis">
      Show refresh times in the model.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#if-bpa-violation-then-reverts-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      If BPA Violation, then reverts deployment.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loop-through-and-query-dax-files" class="md-nav__link">
    <span class="md-ellipsis">
      Loop through and query DAX files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-refreshing-with-pre-and-post-checks" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Refreshing with Pre and Post Checks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query-as-another-user" class="md-nav__link">
    <span class="md-ellipsis">
      Query as Another User
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#refresh-related-tables" class="md-nav__link">
    <span class="md-ellipsis">
      Refresh Related Tables
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#documenting-a-model" class="md-nav__link">
    <span class="md-ellipsis">
      Documenting a Model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Documenting a Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#documenting-a-model_1" class="md-nav__link">
    <span class="md-ellipsis">
      Documenting a Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documenting-a-model-with-cultures" class="md-nav__link">
    <span class="md-ellipsis">
      Documenting a Model with Cultures
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documenting-a-power-bi-local-model" class="md-nav__link">
    <span class="md-ellipsis">
      Documenting a Power BI &gt; Local Model.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contributing" class="md-nav__link">
    <span class="md-ellipsis">
      Contributing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Tabular/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Main Tabular Class
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="query/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Query Model
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="refresh/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Refresh Model
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    PyObject Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            PyObject Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="PyObjects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyObjects
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="PyObject/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyObject
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="PyTables/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTables
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="PyTable/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyTable
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="PyColumns/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyColumns
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="PyColumn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyColumn
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="PyPartitions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyPartitions
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="PyPartition/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyPartition
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="PyMeasures/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyMeasures
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="PyMeasure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    PyMeasure
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Misc. File Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Misc. File Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="tabular_editor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    tabular_editor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="best_practice_analyzer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    best_practice_analyzer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="pbi_helper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pbi_helper
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="logic_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    logic_utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="tabular_tracing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Running Traces
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="document/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documenting Model
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="CONTRIBUTING/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-it" class="md-nav__link">
    <span class="md-ellipsis">
      What is it?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      Getting Started
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-cases" class="md-nav__link">
    <span class="md-ellipsis">
      Use Cases
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Use Cases">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#if-a-blank-table-then-refresh-the-table" class="md-nav__link">
    <span class="md-ellipsis">
      If a blank table, then refresh the table.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sneak-in-a-refresh" class="md-nav__link">
    <span class="md-ellipsis">
      Sneak in a refresh.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#show-refresh-times-in-the-model" class="md-nav__link">
    <span class="md-ellipsis">
      Show refresh times in the model.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#if-bpa-violation-then-reverts-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      If BPA Violation, then reverts deployment.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#loop-through-and-query-dax-files" class="md-nav__link">
    <span class="md-ellipsis">
      Loop through and query DAX files
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advanced-refreshing-with-pre-and-post-checks" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Refreshing with Pre and Post Checks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#query-as-another-user" class="md-nav__link">
    <span class="md-ellipsis">
      Query as Another User
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#refresh-related-tables" class="md-nav__link">
    <span class="md-ellipsis">
      Refresh Related Tables
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#documenting-a-model" class="md-nav__link">
    <span class="md-ellipsis">
      Documenting a Model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Documenting a Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#documenting-a-model_1" class="md-nav__link">
    <span class="md-ellipsis">
      Documenting a Model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documenting-a-model-with-cultures" class="md-nav__link">
    <span class="md-ellipsis">
      Documenting a Model with Cultures
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#documenting-a-power-bi-local-model" class="md-nav__link">
    <span class="md-ellipsis">
      Documenting a Power BI &gt; Local Model.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#contributing" class="md-nav__link">
    <span class="md-ellipsis">
      Contributing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="pytabular">PyTabular</h1>
<p><a href="https://badge.fury.io/py/python-tabular"><img alt="PyPI version" src="https://badge.fury.io/py/python-tabular.svg" /></a>
<a href="https://pepy.tech/project/python-tabular"><img alt="Downloads" src="https://pepy.tech/badge/python-tabular" /></a>
<a href="https://github.com/Curts0/PyTabular/actions/workflows/readthedocs.yml"><img alt="readthedocs" src="https://github.com/Curts0/PyTabular/actions/workflows/readthedocs.yml/badge.svg" /></a>
<a href="https://github.com/Curts0/PyTabular/actions/workflows/pages/pages-build-deployment"><img alt="pages-build-deployment" src="https://github.com/Curts0/PyTabular/actions/workflows/pages/pages-build-deployment/badge.svg" /></a>
<a href="https://github.com/Curts0/PyTabular/actions/workflows/flake8.yml"><img alt="flake8" src="https://github.com/Curts0/PyTabular/actions/workflows/flake8.yml/badge.svg?branch=master" /></a>
<a href="https://github.com/Curts0/PyTabular/actions/workflows/docstr-coverage.yml"><img alt="docstr-coverage" src="https://github.com/Curts0/PyTabular/actions/workflows/docstr-coverage.yml/badge.svg" /></a>
<a href="https://github.com/pre-commit/pre-commit"><img alt="pre-commit" src="https://img.shields.io/badge/pre--commit-enabled-brightgreen?logo=pre-commit" /></a></p>
<h3 id="what-is-it">What is it?</h3>
<p><a href="https://github.com/Curts0/PyTabular">PyTabular</a> (<strong>python-tabular</strong> in <a href="https://pypi.org/project/python-tabular/">pypi</a>) is a python package that allows for programmatic execution on your tabular models! This is possible thanks to <a href="https://pythonnet.github.io/">Pythonnet</a> and Microsoft's <a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.analysisservices?view=analysisservices-dotnet">.Net APIs on Azure Analysis Services</a>. Currently, this build is tested and working on <strong>Windows Operating System only</strong>. Help is needed to expand this for another os. See the <a href="https://curts0.github.io/PyTabular/">Documentation Here</a>. PyTabular is still considered alpha. Please send bugs my way! Preferably in the issues section in Github.</p>
<h3 id="getting-started">Getting Started</h3>
<p>See the <a href="https://pypi.org/project/python-tabular/">Pypi project</a> for available versions.</p>
<div class="admonition danger">
<p class="admonition-title">Before 0.3.5</p>
<p><strong>To become PEP8 compliant with naming conventions, serious name changes were made in 0.3.5.</strong> Install v. 0.3.4 or lower to get the older naming conventions.</p>
</div>
<div class="highlight"><span class="filename">Install Example</span><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">python3</span> <span class="n">-m</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">python-tabular</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="c">#install specific version</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="n">python3</span> <span class="n">-m</span> <span class="n">pip</span> <span class="n">install</span> <span class="n">python-tabular</span><span class="p">==</span><span class="n">0</span><span class="p">.</span><span class="n">3</span><span class="p">.</span><span class="n">4</span>
</code></pre></div>
<p>In your python environment, import pytabular and call the main Tabular Class. The only parameter needed is a solid connection string.</p>
<div class="highlight"><span class="filename">Connecting to Model</span><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">import</span> <span class="nn">pytabular</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">model</span> <span class="o">=</span> <span class="n">pytabular</span><span class="o">.</span><span class="n">Tabular</span><span class="p">(</span><span class="n">CONNECTION_STR</span><span class="p">)</span> <span class="c1"># (1)</span>
</code></pre></div>
<ol>
<li>That's it. A solid connection string.</li>
</ol>
<p>You may have noticed some logging into your console. I'm a big fan of logging, if you don't want any just get the logger and disable it.</p>
<div class="highlight"><span class="filename">Logging Example</span><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">import</span> <span class="nn">pytabular</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">pytabular</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">disabled</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div>
<p>You can query your models with the <code>query()</code> method from your tabular class. For Dax Queries, it will need the full Dax syntax. See <a href="https://dax.guide/st/evaluate/">EVALUATE example</a>. This will return a <a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html">Pandas DataFrame</a>. If you are looking to return a single value, see below. Simply wrap your query in the curly brackets. The method will take that single-cell table and just return the individual value. You can also query your DMV. See below for example.</p>
<div class="highlight"><span class="filename">Query Examples</span><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="c1">#Run basic queries</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">DAX_QUERY</span> <span class="o">=</span> <span class="s2">&quot;EVALUATE TOPN(100, &#39;Table1&#39;)&quot;</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="n">model</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">DAX_QUERY</span><span class="p">)</span> <span class="c1"># (1)</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="c1">#or...</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="n">DMV_QUERY</span> <span class="o">=</span> <span class="s2">&quot;select * from $SYSTEM.DISCOVER_TRACE_EVENT_CATEGORIES&quot;</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="n">model</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">DMV_QUERY</span><span class="p">)</span> <span class="c1"># (2)</span>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="c1">#or...</span>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="n">SINGLE_VALUE_QUERY_EX</span> <span class="o">=</span> <span class="s2">&quot;EVALUATE </span><span class="si">{1}</span><span class="s2">&quot;</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="n">model</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">SINGLE_VALUE_QUERY_EX</span><span class="p">)</span> <span class="c1"># (3)</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="c1">#or...</span>
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a><span class="n">FILE_PATH</span> <span class="o">=</span> <span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">FILEPATHEXAMPLE</span><span class="se">\\</span><span class="s1">file.dax&#39;</span>
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a><span class="n">model</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">FILE_PATH</span><span class="p">)</span> <span class="c1"># (4)</span>
</code></pre></div>
<ol>
<li>Returns a <code>pd.DataFrame()</code>.</li>
<li>Returns a <code>pd.DataFrame()</code>.</li>
<li>This will return a single value. Example, <code>1</code> or <code>'string'</code>.</li>
<li>This will return the same logic as above, single values if possible else will return <code>pd.DataFrame()</code>. Supply any file type.</li>
</ol>
<p>You can also explore your tables, partitions, columns, etc. via the attributes of your <code>Tabular</code> class.</p>
<div class="highlight"><span class="filename">Usage Examples</span><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">model</span><span class="o">.</span><span class="n">Tables</span><span class="p">[</span><span class="s1">&#39;Table Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span> <span class="c1"># (1)</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="c1">#or</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="n">model</span><span class="o">.</span><span class="n">Tables</span><span class="p">[</span><span class="s1">&#39;Table Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">Partitions</span><span class="p">[</span><span class="s1">&#39;Partition Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span> <span class="c1"># (2)</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="c1">#or</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="n">model</span><span class="o">.</span><span class="n">Tables</span><span class="p">[</span><span class="s1">&#39;Table Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">Partitions</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">last_refresh</span><span class="p">()</span> <span class="c1"># (3)</span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="c1">#or</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="n">model</span><span class="o">.</span><span class="n">Tables</span><span class="p">[</span><span class="s1">&#39;Table Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">row_count</span><span class="p">()</span> <span class="c1"># (4)</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="c1">#or</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="n">model</span><span class="o">.</span><span class="n">Tables</span><span class="p">[</span><span class="s1">&#39;Table Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">Columns</span><span class="p">[</span><span class="s1">&#39;Column Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">distinct_count</span><span class="p">()</span> <span class="c1"># (5)</span>
</code></pre></div>
<ol>
<li>Refresh a specific table. The <code>.Tables</code> is your attribute to gain access to your <code>PyTables</code> class. From that, you can iterate into specific <code>PyTable</code> classes.</li>
<li>Refresh a specific partition.</li>
<li>Get the last refresh time of a specific partition. Notice this time that instead of the partition name, an <code>int</code> was used to index into the specific <code>PyPartition</code>.</li>
<li>Get the row count of a table.</li>
<li>Get a distinct count of a column.</li>
</ol>
<p>Use the <code>refresh()</code> method to handle refreshes on your model. This is synchronous. Should be flexible enough to handle a variety of inputs. See <a href="https://curts0.github.io/PyTabular/refresh">PyTabular Docs for Refreshing Tables and Partitions</a>. The most basic way to refresh is to input the table name string. The method will search for the table and output exception if unable to find it. For partitions, you will need a key, and value combination. Example, <code>{'Table1':'Partition1'}</code>. You can also take the key-value pair and iterate through a group of partitions. Example, <code>{'Table1':['Partition1','Partition2']}</code>. Rather than providing a string, you can also input the actual class. See below for those examples. You can access them from the built-in attributes <code>self.Tables</code>, <code>self.Partitions</code>.</p>
<div class="highlight"><span class="filename">Refresh Examples</span><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="n">model</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="s1">&#39;Table Name&#39;</span><span class="p">)</span> <span class="c1"># (1)</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="n">model</span><span class="o">.</span><span class="n">refresh</span><span class="p">([</span><span class="s1">&#39;Table1&#39;</span><span class="p">,</span><span class="s1">&#39;Table2&#39;</span><span class="p">,</span><span class="s1">&#39;Table3&#39;</span><span class="p">])</span> <span class="c1"># (2)</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="c1">#or...</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="n">model</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="o">&lt;</span><span class="n">PyTable</span> <span class="n">Class</span><span class="o">&gt;</span><span class="p">)</span> <span class="c1"># (3)</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="c1">#or...</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="n">model</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="o">&lt;</span><span class="n">PyPartition</span> <span class="n">Class</span><span class="o">&gt;</span><span class="p">)</span> <span class="c1"># (4)</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="c1">#or...</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="n">model</span><span class="o">.</span><span class="n">refresh</span><span class="p">({</span><span class="s1">&#39;Table Name&#39;</span><span class="p">:</span><span class="s1">&#39;Partition Name&#39;</span><span class="p">})</span> <span class="c1"># (5)</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="c1">#or...</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="n">model</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>    <span class="p">[</span>
<a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a>        <span class="p">{</span>
<a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>            <span class="o">&lt;</span><span class="n">PyTable</span> <span class="n">Class</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">PyPartition</span> <span class="n">Class</span><span class="o">&gt;</span><span class="p">,</span>
<a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a>            <span class="s1">&#39;Table Name&#39;</span><span class="p">:[</span><span class="s1">&#39;Partition1&#39;</span><span class="p">,</span><span class="s1">&#39;Partition2&#39;</span><span class="p">]</span>
<a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>        <span class="p">},</span>
<a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a>        <span class="s1">&#39;Table Name&#39;</span><span class="p">,</span>
<a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a>        <span class="s1">&#39;Table Name2&#39;</span>
<a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>    <span class="p">]</span>
<a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a><span class="p">)</span> <span class="c1"># (6)</span>
<a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a>
<a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a><span class="c1">#or...</span>
<a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a><span class="n">model</span><span class="o">.</span><span class="n">Tables</span><span class="p">[</span><span class="s1">&#39;Table Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span> <span class="c1"># (7)</span>
<a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a>
<a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a><span class="c1">#or...</span>
<a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a><span class="n">model</span><span class="o">.</span><span class="n">Tables</span><span class="p">[</span><span class="s1">&#39;Table Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">Partitions</span><span class="p">[</span><span class="s1">&#39;Partition Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span> <span class="c1"># (8)</span>
<a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a>
<a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a><span class="c1">#or...</span>
<a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a><span class="n">model</span><span class="o">.</span><span class="n">refresh</span><span class="p">([</span><span class="s1">&#39;Table1&#39;</span><span class="p">,</span><span class="s1">&#39;Table2&#39;</span><span class="p">],</span> <span class="n">trace</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="c1"># (9)</span>
</code></pre></div>
<ol>
<li>Basic refresh of a specific table by table name string.</li>
<li>Basic refresh of a group of tables by table name strings. An example is with a list, but as long as it's iterable you should be fine.</li>
<li>Refresh a table by passing the <code>PyTable</code> class.</li>
<li>Refresh a partition by passing the <code>PyPartition</code> class.</li>
<li>Refresh a specific partition by passing a dictionary with the table name as the key and the partition name as the value.</li>
<li>Get crazy. Pass all kinds of weird combinations.</li>
<li>Basic refresh from a <code>PyTable</code> class.</li>
<li>Basic refresh from a <code>PyPartition</code> class.</li>
<li>By default, a <code>RefreshTrace</code> is started during refresh. It can be disabled by setting <code>trace = None</code>.</li>
</ol>
<h3 id="use-cases">Use Cases</h3>
<h4 id="if-a-blank-table-then-refresh-the-table">If a blank table, then refresh the table.</h4>
<p>This will use the function <a href="https://curts0.github.io/PyTabular/PyTables/#pytabular.table.PyTables.find_zero_rows">find_zero_rows</a> and the method <a href="https://curts0.github.io/PyTabular/PyTables/#pytabular.table.PyTables.refresh">refresh</a> from the Tabular class.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kn">import</span> <span class="nn">pytabular</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="n">model</span> <span class="o">=</span> <span class="n">pytabular</span><span class="o">.</span><span class="n">Tabular</span><span class="p">(</span><span class="n">CONNECTION_STR</span><span class="p">)</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="n">tables</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Tables</span><span class="o">.</span><span class="n">find_zero_rows</span><span class="p">()</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tables</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>    <span class="n">tables</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</code></pre></div>
<p>Maybe you only want to check a subset of tables? Like <code>find()</code> tables with 'fact' in the name, then check if any facts are blank.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="kn">import</span> <span class="nn">pytabular</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="n">model</span> <span class="o">=</span> <span class="n">pytabular</span><span class="o">.</span><span class="n">Tabular</span><span class="p">(</span><span class="n">CONNECTION_STR</span><span class="p">)</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="n">tables</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Tables</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;fact&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find_zero_rows</span><span class="p">()</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">tables</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>    <span class="n">tables</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</code></pre></div>
<h4 id="sneak-in-a-refresh">Sneak in a refresh.</h4>
<p>This will use the method <a href="https://curts0.github.io/PyTabular/Tabular/#pytabular.pytabular.Tabular.is_process">is_process</a> and the method <a href="https://curts0.github.io/PyTabular/Tabular/#pytabular.pytabular.Tabular.refresh">refresh</a> from the Tabular class. It will check the DMV to see if any jobs are currently running and classified as processing.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="kn">import</span> <span class="nn">pytabular</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="n">model</span> <span class="o">=</span> <span class="n">pytabular</span><span class="o">.</span><span class="n">Tabular</span><span class="p">(</span><span class="n">CONNECTION_STR</span><span class="p">)</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="k">if</span> <span class="n">model</span><span class="o">.</span><span class="n">is_process</span><span class="p">():</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>    <span class="c1">#do what you want if there is a refresh happening</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="k">else</span><span class="p">:</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>    <span class="n">model</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">TABLES_OR_PARTITIONS_TO_REFRESH</span><span class="p">)</span>
</code></pre></div>
<h4 id="show-refresh-times-in-the-model">Show refresh times in the model.</h4>
<p>This will use the function <a href="https://curts0.github.io/PyTabular/PyTables/#pytabular.table.PyTables.last_refresh">last_refresh</a> and the method <a href="https://curts0.github.io/PyTabular/Tabular/#pytabular.pytabular.Tabular.create_table">create_table</a> from the Tabular class. It will search through the model for all tables and partitions and pull the 'RefreshedTime' property from it. It will return results into a pandas data frame, which will then be converted into an M expression used for a new table.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="kn">import</span> <span class="nn">pytabular</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="n">model</span> <span class="o">=</span> <span class="n">pytabular</span><span class="o">.</span><span class="n">Tabular</span><span class="p">(</span><span class="n">CONNECTION_STR</span><span class="p">)</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="n">df</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Tables</span><span class="o">.</span><span class="n">last_refresh</span><span class="p">()</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="n">model</span><span class="o">.</span><span class="n">create_table</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;Refresh Times&#39;</span><span class="p">)</span>
</code></pre></div>
<h4 id="if-bpa-violation-then-reverts-deployment">If BPA Violation, then reverts deployment.</h4>
<p>This uses a few things. First the <a href="https://curts0.github.io/PyTabular/best_practice_analyzer/">BPA Class</a>, then the <a href="https://curts0.github.io/PyTabular/tabular_editor/">TE2 Class</a>, and will finish with the <a href="https://curts0.github.io/PyTabular/Tabular/#pytabular.pytabular.Tabular.analyze_bpa">analyze_bpa</a> method. Did not want to reinvent the wheel with the amazing work done with Tabular Editor and its BPA capabilities.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="kn">import</span> <span class="nn">pytabular</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="n">model</span> <span class="o">=</span> <span class="n">pytabular</span><span class="o">.</span><span class="n">Tabular</span><span class="p">(</span><span class="n">CONNECTION_STR</span><span class="p">)</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="c1"># Feel free to input your TE2 File path or this will download for you.</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="n">te2</span> <span class="o">=</span> <span class="n">pytabular</span><span class="o">.</span><span class="n">TabularEditor</span><span class="p">()</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="c1"># Feel free to input your own BPA file or this will download for you from:</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="c1"># https://raw.githubusercontent.com/microsoft/Analysis-Services/master/BestPracticeRules/BPARules.json</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="n">bpa</span> <span class="o">=</span> <span class="n">pytabular</span><span class="o">.</span><span class="n">BPA</span><span class="p">()</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">analyze_bpa</span><span class="p">(</span><span class="n">te2</span><span class="o">.</span><span class="n">exe</span><span class="p">,</span><span class="n">bpa</span><span class="o">.</span><span class="n">location</span><span class="p">)</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">results</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>    <span class="c1">#Revert deployment here!</span>
</code></pre></div>
<h4 id="loop-through-and-query-dax-files">Loop through and query DAX files</h4>
<p>Let's say you have multiple DAX queries you would like to store and run through as checks. The <a href="https://curts0.github.io/PyTabular/query/#pytabular.query.Connection.query">query</a> method on the Tabular class can also take file paths. It can be any file type as it's just checking <code>os.path.isfile()</code>. But would suggest <code>.dax</code> or <code>.txt</code>. It will read the file and use that as the new <code>query_str</code> argument.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="kn">import</span> <span class="nn">pytabular</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="n">model</span> <span class="o">=</span> <span class="n">pytabular</span><span class="o">.</span><span class="n">Tabular</span><span class="p">(</span><span class="n">CONNECTION_STR</span><span class="p">)</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="n">LIST_OF_FILE_PATHS</span> <span class="o">=</span> <span class="p">[</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>    <span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">FilePath</span><span class="se">\\</span><span class="s1">file1.dax&#39;</span><span class="p">,</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>    <span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">FilePath</span><span class="se">\\</span><span class="s1">file1.txt&#39;</span><span class="p">,</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a>    <span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">FilePath</span><span class="se">\\</span><span class="s1">file2.dax&#39;</span><span class="p">,</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a>    <span class="s1">&#39;C:</span><span class="se">\\</span><span class="s1">FilePath</span><span class="se">\\</span><span class="s1">file2.txt&#39;</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="p">]</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a><span class="k">for</span> <span class="n">file_path</span> <span class="ow">in</span> <span class="n">LIST_OF_FILE_PATHS</span><span class="p">:</span>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a>    <span class="n">model</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</code></pre></div>
<h4 id="advanced-refreshing-with-pre-and-post-checks">Advanced Refreshing with Pre and Post Checks</h4>
<p>Maybe you are introducing new logic to a fact table, and you need to ensure that a measure checking last month's values never changes. To do that you can take advantage of the <code>RefreshCheck</code> and <code>RefreshCheckCollection</code> classes. But using those you can build out something that would first check the results of the measure, then refresh, then check the results of the measure after the refresh, and lastly perform your desired check. In this case, the <code>pre</code> value matches the <code>post</code> value. When refreshing, if your pre does not equal post, it would fail and give an assertion error in your logging.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="kn">from</span> <span class="nn">pytabular</span> <span class="kn">import</span> <span class="n">Tabular</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="kn">from</span> <span class="nn">pytabular.refresh</span> <span class="kn">import</span> <span class="n">RefreshCheck</span><span class="p">,</span> <span class="n">RefreshCheckCollection</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="n">model</span> <span class="o">=</span> <span class="n">Tabular</span><span class="p">(</span><span class="n">CONNECTION_STR</span><span class="p">)</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="c1"># This is our custom check that we want to run after refresh.</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="c1"># Does the pre refresh value match the post refresh value.</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="k">def</span> <span class="nf">sum_of_sales_assertion</span><span class="p">(</span><span class="n">pre</span><span class="p">,</span> <span class="n">post</span><span class="p">):</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a>    <span class="k">return</span> <span class="n">pre</span> <span class="o">==</span> <span class="n">post</span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="c1"># This is where we put it all together into the `RefreshCheck` class. Give it a name, give it a query to run, and give it the assertion you want to make.</span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="n">sum_of_last_month_sales</span> <span class="o">=</span> <span class="n">RefreshCheck</span><span class="p">(</span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>    <span class="s1">&#39;Last Month Sales&#39;</span><span class="p">,</span>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a>    <span class="k">lambda</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;EVALUATE {[Last Month Sales]}&quot;</span><span class="p">)</span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a>    <span class="p">,</span><span class="n">sum_of_sales_assertion</span>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="p">)</span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span class="c1"># Here we are adding it to a `RefreshCheckCollection` because you can have more than on `Refresh_Check` to run.</span>
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a><span class="n">all_refresh_check</span> <span class="o">=</span> <span class="n">RefreshCheckCollection</span><span class="p">([</span><span class="n">sum_of_last_month_sales</span><span class="p">])</span>
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a>
<a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a><span class="n">model</span><span class="o">.</span><span class="n">Refresh</span><span class="p">(</span>
<a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a>    <span class="s1">&#39;Fact Table Name&#39;</span><span class="p">,</span>
<a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a>    <span class="n">refresh_checks</span> <span class="o">=</span> <span class="n">RefreshCheckCollection</span><span class="p">([</span><span class="n">sum_of_last_month_sales</span><span class="p">])</span>
<a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a>
<a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a><span class="p">)</span>
</code></pre></div>
<h4 id="query-as-another-user">Query as Another User</h4>
<p>There are plenty of tools that allow you to query as an 'Effective User' inheriting their security when querying. This is an extremely valuable concept built natively into the .Net APIs. My only gripe is they were all UI based. This allows you to programmatically connect as an effective user and query in Python. You could easily loop through all your users to run tests on their security.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kn">import</span> <span class="nn">pytabular</span> <span class="k">as</span> <span class="nn">p</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="c1">#Connect to your model like usual...</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="n">model</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">Tabular</span><span class="p">(</span><span class="n">CONNECTION_STR</span><span class="p">)</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="c1">#This will be the query I run...</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="n">query_str</span> <span class="o">=</span> <span class="s1">&#39;&#39;&#39;</span>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a><span class="s1">EVALUATE</span>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a><span class="s1">SUMMARIZE(</span>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a><span class="s1">    &#39;Product Dimension&#39;,</span>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a><span class="s1">    &#39;Product Dimension&#39;[Product Name],</span>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a><span class="s1">    &quot;Total Product Sales&quot;, [Total Sales]</span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a><span class="s1">)</span>
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a><span class="s1">&#39;&#39;&#39;</span>
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a><span class="c1">#This will be the user I want to query as...</span>
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a><span class="n">user_email</span> <span class="o">=</span> <span class="s1">&#39;user1@company.com&#39;</span>
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a>
<a id="__codelineno-13-18" name="__codelineno-13-18" href="#__codelineno-13-18"></a><span class="c1">#Base line, to query as the user connecting to the model.</span>
<a id="__codelineno-13-19" name="__codelineno-13-19" href="#__codelineno-13-19"></a><span class="n">model</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query_str</span><span class="p">)</span>
<a id="__codelineno-13-20" name="__codelineno-13-20" href="#__codelineno-13-20"></a>
<a id="__codelineno-13-21" name="__codelineno-13-21" href="#__codelineno-13-21"></a><span class="c1">#Option 1, Connect via connection class...</span>
<a id="__codelineno-13-22" name="__codelineno-13-22" href="#__codelineno-13-22"></a><span class="n">user1</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">Connection</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">Server</span><span class="p">,</span> <span class="n">effective_user</span> <span class="o">=</span> <span class="n">user_email</span><span class="p">)</span>
<a id="__codelineno-13-23" name="__codelineno-13-23" href="#__codelineno-13-23"></a><span class="n">user1</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query_str</span><span class="p">)</span>
<a id="__codelineno-13-24" name="__codelineno-13-24" href="#__codelineno-13-24"></a>
<a id="__codelineno-13-25" name="__codelineno-13-25" href="#__codelineno-13-25"></a><span class="c1">#Option 2, Just add Effective_User</span>
<a id="__codelineno-13-26" name="__codelineno-13-26" href="#__codelineno-13-26"></a><span class="n">model</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="n">query_str</span><span class="p">,</span> <span class="n">effective_user</span> <span class="o">=</span> <span class="n">user_email</span><span class="p">)</span>
<a id="__codelineno-13-27" name="__codelineno-13-27" href="#__codelineno-13-27"></a>
<a id="__codelineno-13-28" name="__codelineno-13-28" href="#__codelineno-13-28"></a><span class="c1">#PyTabular will do it&#39;s best to handle multiple accounts...</span>
<a id="__codelineno-13-29" name="__codelineno-13-29" href="#__codelineno-13-29"></a><span class="c1">#So you won&#39;t have to reconnect on every query</span>
</code></pre></div>
<h4 id="refresh-related-tables">Refresh Related Tables</h4>
<p>Ever need to refresh related tables of a Fact? Now should be a lot easier.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="kn">import</span> <span class="nn">pytabular</span> <span class="k">as</span> <span class="nn">p</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="c1">#Connect to model</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="n">model</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">Tabular</span><span class="p">(</span><span class="n">CONNECTION_STR</span><span class="p">)</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="c1">#Get related tables</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="n">tables</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Tables</span><span class="p">[</span><span class="n">TABLE_NAME</span><span class="p">]</span><span class="o">.</span><span class="n">related</span><span class="p">()</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="c1">#Now just refresh like usual...</span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="n">tables</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
</code></pre></div>
<h2 id="documenting-a-model">Documenting a Model</h2>
<p>The Tabular model contains a lot of information (meta-data) that can be used to generate documentation if filled in. Currently, the markdown files are generated with the Docusaurs heading in place, but this will be changed in the future to support multiple documentation platforms.</p>
<p><strong>Tip</strong>: With Tabular Editor 2 (Free) or 3 (Paid) you can easily add Descriptions, Translations (Cultures) and other additional information that can later be used for generating the documentation.</p>
<p>Args:</p>
<ul>
<li><strong>model</strong>: Tabular</li>
<li><strong>friendly_name</strong>: Default &gt; No Value</li>
</ul>
<p>To specify the location of the docs, just supply the location of where you want to store the files (=<code>save_location</code>).</p>
<ul>
<li><strong>save_location</strong>: Default &gt; docs</li>
</ul>
<p>Each page in the generation process has its own specific name, with these arguments you can rename them to your liking.</p>
<ul>
<li><strong>general_page_url</strong>: Default &gt; index.md</li>
<li><strong>measure_page_url</strong>: Default &gt; measures.md</li>
<li><strong>table_folder</strong>: Default &gt; tables</li>
<li><strong>column_page_url</strong>: Default &gt; 4-columns.md</li>
</ul>
<p><strong>Folder structure</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>adventure-works &gt; Model Name
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a> index.md &gt; General Information
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a> measures.md &gt; Page with all measures in the model.
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a> tables
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>    index.md &gt; Overview page with all tables in the model and a summary per table.
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>|    technical_table_name.md &gt; Details of a specific table with all columns and attributes.
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>|    ......md
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>|    ......md
</code></pre></div>
<h3 id="documenting-a-model_1">Documenting a Model</h3>
<p>The simplest way to document a tabular model is to connect to the model, initialize the documentation and execute <code>save_documentation()</code>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="kn">import</span> <span class="nn">pytabular</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="c1"># Connect to a Tabular Model Model</span>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="n">model</span> <span class="o">=</span> <span class="n">pytabular</span><span class="o">.</span><span class="n">Tabular</span><span class="p">(</span><span class="n">CONNECTION_STR</span><span class="p">)</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="c1"># Initiate the Docs</span>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="n">docs</span> <span class="o">=</span> <span class="n">pytabular</span><span class="o">.</span><span class="n">ModelDocumenter</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a><span class="c1"># Generate the pages.</span>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="n">docs</span><span class="o">.</span><span class="n">generate_documentation_pages</span><span class="p">()</span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>
<a id="__codelineno-16-12" name="__codelineno-16-12" href="#__codelineno-16-12"></a><span class="c1"># Save docs to the default location</span>
<a id="__codelineno-16-13" name="__codelineno-16-13" href="#__codelineno-16-13"></a><span class="n">docs</span><span class="o">.</span><span class="n">save_documentation</span><span class="p">()</span>
</code></pre></div>
<h3 id="documenting-a-model-with-cultures">Documenting a Model with Cultures</h3>
<p>Some model creators choose to add cultures to a tabular model for different kinds of reasons. We can leverage those cultures to use the translation names instead of the original object names. To enable this, you can set translations to <code>True</code> and specify the culture you want to use (e.g. <code>'en-US'</code>).</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="kn">import</span> <span class="nn">pytabular</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="c1"># Connect to a Tabular Model Model</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="n">model</span> <span class="o">=</span> <span class="n">pytabular</span><span class="o">.</span><span class="n">Tabular</span><span class="p">(</span><span class="n">CONNECTION_STR</span><span class="p">)</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="c1"># Initiate the Docs</span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="n">docs</span> <span class="o">=</span> <span class="n">pytabular</span><span class="o">.</span><span class="n">ModelDocumenter</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a><span class="c1"># Set the translation for documentation to an available culture.</span>
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a><span class="c1"># By setting the Tranlsations to `True` it will check if it exists and if it does,</span>
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a><span class="c1"># it will start using the translations for the docs</span>
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a><span class="n">docs</span><span class="o">.</span><span class="n">set_translations</span><span class="p">(</span>
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>        <span class="n">enable_translations</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a>        <span class="n">culture</span> <span class="o">=</span> <span class="s1">&#39;en-US&#39;</span>
<a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a>    <span class="p">)</span>
<a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a>
<a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a><span class="c1"># Generate the pages.</span>
<a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a><span class="n">docs</span><span class="o">.</span><span class="n">generate_documentation_pages</span><span class="p">()</span>
<a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a>
<a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a><span class="c1"># Save docs to the default location</span>
<a id="__codelineno-17-21" name="__codelineno-17-21" href="#__codelineno-17-21"></a><span class="n">docs</span><span class="o">.</span><span class="n">save_documentation</span><span class="p">()</span>
</code></pre></div>
<h3 id="documenting-a-power-bi-local-model">Documenting a Power BI &gt; Local Model.</h3>
<p>The Local model doesn't have a "name", only an Id. So we need to Supply a "Friendly Name", which will be used to store the markdown files.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="kn">import</span> <span class="nn">pytabular</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="c1"># Connect to a Tabular Model Model</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="n">model</span> <span class="o">=</span> <span class="n">pytabular</span><span class="o">.</span><span class="n">Tabular</span><span class="p">(</span><span class="n">CONNECTION_STR</span><span class="p">)</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="c1"># Initiate the Docs and set a friendly name to store the markdown files.</span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="n">docs</span> <span class="o">=</span> <span class="n">pytabular</span><span class="o">.</span><span class="n">ModelDocumenter</span><span class="p">(</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a>    <span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="p">,</span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a>    <span class="n">friendly_name</span> <span class="o">=</span> <span class="s2">&quot;Adventure Works&quot;</span>
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="p">)</span>
<a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a>
<a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="c1"># Generate the pages.</span>
<a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="n">docs</span><span class="o">.</span><span class="n">generate_documentation_pages</span><span class="p">()</span>
<a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a>
<a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="c1"># Save docs to the default location</span>
<a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="n">docs</span><span class="o">.</span><span class="n">save_documentation</span><span class="p">()</span>
</code></pre></div>
<h3 id="contributing">Contributing</h3>
<p>See <a href="CONTRIBUTING/">contributing.md</a></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["content.code.annotate"], "search": "assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.d7c377c4.min.js"></script>
      
    
  </body>
</html>